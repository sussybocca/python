<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyPythonEditor Web</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #tabs button { margin-right: 5px; margin-bottom: 10px; }
        #editors { margin-top: 10px; }
        textarea { width: 100%; height: 300px; font-family: monospace; font-size: 14px; }
        pre { background: #f5f5f5; padding: 10px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>MyPythonEditor (Web)</h1>

    <div id="tabs">
        <button onclick="addTab()">+ New File</button>
        <button onclick="saveCurrent()">Save</button>
        <button onclick="openFile()">Open</button>
        <button onclick="runPython()">Run Python</button>
        <button onclick="lintJS()">Lint JS</button>
    </div>

    <div id="editors">
        <textarea id="editor"></textarea>
    </div>

    <h2>Output:</h2>
    <pre id="output"></pre>

    <script>
        const editor = document.getElementById("editor");

        // Add new file (clears editor)
        function addTab() {
            editor.value = "";
            document.getElementById("output").innerText = "";
        }

        // Save file
        function saveCurrent() {
            const filename = prompt("Enter filename:");
            if (!filename) return;

            fetch("/save", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ filename, code: editor.value })
            })
            .then(res => res.json())
            .then(data => alert(data.status));
        }

        // Open file
        function openFile() {
            const filename = prompt("Enter filename to open:");
            if (!filename) return;

            fetch(`/open?filename=${encodeURIComponent(filename)}`)
            .then(res => res.json())
            .then(data => {
                if (data.code !== undefined) {
                    editor.value = data.code;
                } else {
                    alert(data.error);
                }
            });
        }

        // Run Python code
        function runPython() {
            fetch("/run/python", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ code: editor.value })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("output").innerText = data.output;
            });
        }

        // Lint JavaScript code
        function lintJS() {
            fetch("/lint/js", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ code: editor.value })
            })
            .then(res => res.json())
            .then(data => {
                editor.value = data.fixed_code;
                alert("JS code linted/fixed!");
            });
        }
    </script>
</body>
</html>
